<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Repeated measurements of lettuce growth — pederson.lettuce.repeated • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Repeated measurements of lettuce growth — pederson.lettuce.repeated" />
<meta property="og:description" content="Repeated measurements of lettuce growth for 3 treatments." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_intro.html">Introduction to `agridat`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Repeated measurements of lettuce growth</h1>
    
    <div class="hidden name"><code>pederson.lettuce.repeated.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Repeated measurements of lettuce growth for 3 treatments.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"pederson.lettuce.repeated"</span><span class='op'>)</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>A data frame with 594 observations on the following 4 variables.</p><dl>
    <dt><code>plant</code></dt><dd><p>plant number</p></dd>
    <dt><code>day</code></dt><dd><p>day of observation</p></dd>
    <dt><code>trt</code></dt><dd><p>treatment</p></dd>
    <dt><code>weight</code></dt><dd><p>weight</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Experiment conducted in a greenhouse in Silver Bay, Minnesota. Plants were grown hydroponically.
Treatment 1 had 9 plants per raft. Treatment 2 had 18 plants, treatment 3 had 36 plants.
The response variable is weight of plant, roots, soil, cup, and water. The plants were measured repeatedly beginning Dec 1, and ending Jan 9, when the plants were harvested.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Levi Dawson Pederson (2015).
Mixed Model Analysis for Repeated Measures of Lettuce Growth
Thesis at University of Minnesota. Appendix C.
https://scse.d.umn.edu/sites/scse.d.umn.edu/files/pedersonprojectthesis.pdf</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>None</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://kwstat.github.io/agridat/'>agridat</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pederson.lettuce.repeated</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>pederson.lettuce.repeated</span>

<span class='fu'><a href='libs.html'>libs</a></span><span class='op'>(</span><span class='va'>lattice</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>day</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span><span class='va'>weight</span> <span class='op'>~</span> <span class='va'>day</span><span class='op'>|</span><span class='va'>trt</span>, <span class='va'>dat</span>, type<span class='op'>=</span><span class='st'>'l'</span>, group<span class='op'>=</span><span class='va'>plant</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span>,
main<span class='op'>=</span><span class='st'>"pederson.lettuce.repeated"</span><span class='op'>)</span>
</div><div class='img'><img src='pederson.lettuce.repeated-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># \dontrun{</span>
<span class='co'># Pederson used this SAS MIXED model for unstructured covariance</span>
<span class='co'># proc mixed data=Project.Spacingdata; </span>
<span class='co'># class trt plant day; </span>
<span class='co'># model weight=trt day trt*day; </span>
<span class='co'># repeated day / subject=plant type=un r rcorr;   </span>

<span class='co'># This should give the same results as SAS, but does not.</span>
<span class='fu'><a href='libs.html'>libs</a></span><span class='op'>(</span><span class='va'>nlme</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='va'>dat</span>, plant<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>plant</span><span class='op'>)</span>, day<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>datg</span> <span class='op'>&lt;-</span> <span class='fu'>groupedData</span><span class='op'>(</span><span class='va'>weight</span> <span class='op'>~</span> <span class='va'>day</span><span class='op'>|</span><span class='va'>plant</span>, data<span class='op'>=</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>un1</span> <span class='op'>&lt;-</span> <span class='fu'>gls</span><span class='op'>(</span><span class='va'>weight</span> <span class='op'>~</span> <span class='va'>trt</span> <span class='op'>*</span> <span class='va'>day</span>, data<span class='op'>=</span><span class='va'>datg</span>,
           correlation<span class='op'>=</span><span class='fu'>corSymm</span><span class='op'>(</span>value<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>.6</span>,<span class='fl'>55</span><span class='op'>)</span>, form <span class='op'>=</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='va'>plant</span><span class='op'>)</span>,
           control<span class='op'>=</span><span class='fu'>lmeControl</span><span class='op'>(</span>opt<span class='op'>=</span><span class='st'>"optim"</span>, msVerbose<span class='op'>=</span><span class='cn'>TRUE</span>,
                              maxIter<span class='op'>=</span><span class='fl'>500</span>, msMaxIter<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; initial  value 2429.796794 
#&gt; iter  10 value 2043.265582
#&gt; iter  20 value 2026.878345
#&gt; iter  30 value 1991.844910
#&gt; iter  40 value 1974.144855
#&gt; iter  50 value 1962.086595
#&gt; iter  60 value 1957.390081
#&gt; final  value 1957.093673 
#&gt; converged</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span><span class='op'>(</span><span class='va'>un1</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>2</span> <span class='co'># nlme has 1955, SAS had 1898.6</span>
</div><div class='output co'>#&gt; 'log Lik.' -1955.263 (df=89)</div><div class='input'>
<span class='co'># Comparing the SAS results in Pederson (page 16) and the nlme results, we notice</span>
<span class='co'># the SAS correlations in table 5.2 are unusually low for the first</span>
<span class='co'># column. The nlme results have a higher correlation in the first column</span>
<span class='co'># and just "look" better</span>
<span class='va'>un1</span>
</div><div class='output co'>#&gt; Generalized least squares fit by REML
#&gt;   Model: weight ~ trt * day 
#&gt;   Data: datg 
#&gt;   Log-restricted-likelihood: -977.6315
#&gt; 
#&gt; Coefficients:
#&gt; (Intercept)       trtT2       trtT3        day5        day8       day12 
#&gt; 49.26666667 -0.46111111  0.69444444  0.73888889  2.57222222  4.42777778 
#&gt;       day15       day18       day21       day26       day33       day36 
#&gt;  5.66666667  7.05555556 11.14444444 19.70555556 26.26111111 32.78888889 
#&gt;       day40  trtT2:day5  trtT3:day5  trtT2:day8  trtT3:day8 trtT2:day12 
#&gt; 38.73333333  0.75555556  1.56111111  0.56111111  0.76111111  0.06111111 
#&gt; trtT3:day12 trtT2:day15 trtT3:day15 trtT2:day18 trtT3:day18 trtT2:day21 
#&gt;  0.51666667 -0.05555556  0.69444444 -0.27777778  0.96666667 -0.66666667 
#&gt; trtT3:day21 trtT2:day26 trtT3:day26 trtT2:day33 trtT3:day33 trtT2:day36 
#&gt; -0.86666667 -1.72222222 -3.48333333 -2.55000000 -0.43888889 -2.55000000 
#&gt; trtT3:day36 trtT2:day40 trtT3:day40 
#&gt; -1.89444444 -3.07222222 -6.53888889 
#&gt; 
#&gt; Correlation Structure: General
#&gt;  Formula: ~1 | plant 
#&gt;  Parameter estimate(s):
#&gt;  Correlation: 
#&gt;    1     2     3     4     5     6     7     8     9     10   
#&gt; 2  0.945                                                      
#&gt; 3  0.942 0.980                                                
#&gt; 4  0.938 0.962 0.986                                          
#&gt; 5  0.919 0.944 0.973 0.990                                    
#&gt; 6  0.901 0.922 0.951 0.974 0.994                              
#&gt; 7  0.883 0.900 0.929 0.956 0.971 0.979                        
#&gt; 8  0.803 0.803 0.845 0.879 0.895 0.909 0.955                  
#&gt; 9  0.706 0.701 0.741 0.777 0.799 0.821 0.882 0.954            
#&gt; 10 0.504 0.515 0.555 0.602 0.629 0.656 0.743 0.866 0.944      
#&gt; 11 0.537 0.551 0.587 0.633 0.657 0.683 0.763 0.864 0.929 0.963
#&gt; Degrees of freedom: 594 total; 561 residual
#&gt; Residual standard error: 5.564987 </div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


