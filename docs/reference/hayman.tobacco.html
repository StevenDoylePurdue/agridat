<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Diallel cross of Aztec tobacco — hayman.tobacco • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Diallel cross of Aztec tobacco — hayman.tobacco"><meta property="og:description" content="Diallel cross of Aztec tobacco in 2 reps"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/agridat_data.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_intro.html">Introduction to `agridat`</a>
    </li>
    <li>
      <a href="../articles/agridat_uniformity.html">Notes on uniformity data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kwstat/agridat/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diallel cross of Aztec tobacco</h1>
    
    <div class="hidden name"><code>hayman.tobacco.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Diallel cross of Aztec tobacco in 2 reps</p>
    </div>


    <div id="format">
    <h2>Format</h2>
    

<p></p><dl><dt><code>year</code></dt>
<dd><p>year</p></dd>

    <dt><code>block</code></dt>
<dd><p>block factor, 2 levels</p></dd>

    <dt><code>male</code></dt>
<dd><p>male parent, 8 levels</p></dd>

    <dt><code>female</code></dt>
<dd><p>female parent</p></dd>

    <dt><code>day</code></dt>
<dd><p>mean flowering time (days)</p></dd>

  
</dl></div>
    <div id="details">
    <h2>Details</h2>
    
  
<p>Data was collected in 1951 (Hayman 1954a) and 1952 (Hayman 1954b).</p>
<p>In each year there were 8 varieties of Aztec tobacco, <em>Nicotiana rustica L.</em>.</p>
<p>Each cross/self was represented by 10 progeny, in two plots of 5
  plants each.  The data are the mean flowering time per plot.</p>
<p>Note, the 1951 data as published in Hayman (1954a) Table 5 contain
  "10 times the mean flowering time".  The data here have been divided
  by 10 so as to be comparable with the 1952 data.</p>
<p>Hayman (1954b) says "Table 2 lists...three characters from a diallel
  cross of Nicotiana rustica varieties which was repeated for three years."
  This seems to indicate that the varieties are the same in 1951 and
  1952.  Calculating the GCA effects separately for 1951 and 1952 and
  then comparing these estimates shows that they are highly correlated.</p>
    </div>
    <div id="source">
    <h2>Source</h2>
    

<p>B. I. Hayman (1954a). The Analysis of Variance of Diallel Tables.
  <em>Biometrics</em>, 10, 235-244.  Table 5, page 241.
  https://doi.org/10.2307/3001877</p>
<p>Hayman, B.I. (1954b). The theory and analysis of diallel crosses.
  <em>Genetics</em>, 39, 789-809.  Table 3, page 805.
  https://www.genetics.org/content/39/6/789.full.pdf</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p># For 1951 data</p>
<p>Mohring, Melchinger, Piepho. (2011).
  REML-Based Diallel Analysis.
  <em>Crop Science</em>, 51, 470-478.</p>
<p># For 1952 data</p>
<p>C. Clark Cockerham and B. S. Weir. (1977).
  Quadratic analyses of reciprocal crosses.
  <em>Biometrics</em> 33, 187-203.  Appendix C.</p>
<p>Andrea Onofri, Niccolo Terzaroli, Luigi Russi (2020).
  Linear models for diallel crosses: A review with R functions.
  Theoretical and Applied Genetics.
  https://doi.org/10.1007/s00122-020-03716-8</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># 1951 data.  Fit the first REML model of Mohring 2011 Supplement.  </span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hayman.tobacco</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hayman.tobacco</span>, <span class="va">year</span><span class="op">==</span><span class="fl">1951</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Hayman's model</span></span>
<span class="r-in">  <span class="co"># dat1 &lt;- subset(hayman.tobacco, year==1951)</span></span>
<span class="r-in">  <span class="co"># libs(lmDiallel)</span></span>
<span class="r-in">  <span class="co"># m1  &lt;- lm.diallel(day ~ male+female, Block=block, data=dat1, fct="HAYMAN2")</span></span>
<span class="r-in">  <span class="co"># anova(m1) # Similar to table 7 of Hayman 1954a</span></span>
<span class="r-in">  <span class="co">## Response: day</span></span>
<span class="r-in">  <span class="co">##                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span class="r-in">  <span class="co">## Block           1    1.42    1.42  0.3416   0.56100    </span></span>
<span class="r-in">  <span class="co">## Mean Dom. Dev.  1  307.97  307.97 73.8840 3.259e-12 ***</span></span>
<span class="r-in">  <span class="co">## GCA             7 2777.17  396.74 95.1805 &lt; 2.2e-16 ***</span></span>
<span class="r-in">  <span class="co">## Dom. Dev.       7  341.53   48.79 11.7050 1.957e-09 ***</span></span>
<span class="r-in">  <span class="co">## SCA            20  372.89   18.64  4.4729 2.560e-06 ***</span></span>
<span class="r-in">  <span class="co">## RGCA            7   67.39    9.63  2.3097   0.03671 *  </span></span>
<span class="r-in">  <span class="co">## RSCA           21  123.73    5.89  1.4135   0.14668    </span></span>
<span class="r-in">  <span class="co">## Residuals      63  262.60                              </span></span>
<span class="r-in"></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Griffing's model</span></span>
<span class="r-in">  <span class="co"># https://www.statforbiology.com/2021/stat_met_diallel_griffing/</span></span>
<span class="r-in">  <span class="co"># dat1 &lt;- subset(hayman.tobacco, year==1951)</span></span>
<span class="r-in">  <span class="co"># libs(lmDiallel)</span></span>
<span class="r-in">  <span class="co"># contrasts(dat1$block) &lt;- "contr.sum"</span></span>
<span class="r-in">  <span class="co"># dmod1 and dmod2 are the same model with different syntax</span></span>
<span class="r-in">  <span class="co"># dmod1 &lt;- lm(day ~ block + GCA(male, female) + tSCA(male, female) +</span></span>
<span class="r-in">  <span class="co">#               REC(male, female) , data = dat1)</span></span>
<span class="r-in">  <span class="co"># dmod2 &lt;- lm.diallel(day ~ male + female, Block=block, </span></span>
<span class="r-in">  <span class="co">#                     data = dat1, fct = "GRIFFING1")</span></span>
<span class="r-in">  <span class="co"># anova(dmod1)</span></span>
<span class="r-in">  <span class="co"># anova(dmod2)</span></span>
<span class="r-in">  <span class="co">## Response: day</span></span>
<span class="r-in">  <span class="co">##             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span class="r-in">  <span class="co">## Block        1    1.42    1.42  0.3416   0.56100    </span></span>
<span class="r-in">  <span class="co">## GCA          7 2777.17  396.74 95.1805 &lt; 2.2e-16 ***</span></span>
<span class="r-in">  <span class="co">## SCA         28 1022.38   36.51  8.7599 6.656e-13 ***</span></span>
<span class="r-in">  <span class="co">## Reciprocals 28  191.12    6.83  1.6375   0.05369 .  </span></span>
<span class="r-in">  <span class="co">## Residuals   63  262.60                              </span></span>
<span class="r-in"></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Make a factor 'comb' in which G1xG2 is the same cross as G2xG1</span></span>
<span class="r-in">  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span>
<span class="r-in">                    comb <span class="op">=</span></span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>,</span>
<span class="r-in">                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">male</span>,<span class="va">female</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">female</span>,<span class="va">male</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># 'dr' is the direction of the cross, 0 for self</span></span>
<span class="r-in">  <span class="va">dat1</span><span class="op">$</span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span class="r-in">  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span>
<span class="r-in">                    dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, <span class="va">dr</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span>
<span class="r-in">                    dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">dr</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># asreml r version 3 &amp; 4 code for Mixed Griffing.</span></span>
<span class="r-in">  <span class="co"># Mohring Table 2, column 2 (after dividing by 10^2) gives variances:</span></span>
<span class="r-in">  <span class="co"># GCA 12.77, SCA 11.09, RSCA .65, Error 4.23.</span></span>
<span class="r-in">  <span class="co"># Mohring Supplement ASREML code part1 model is:</span></span>
<span class="r-in">  <span class="co"># y ~ mu r !r mother and(father) combination combination.dr</span></span>
<span class="r-in">  <span class="co"># Note that the levels of 'male' and 'female' are the same, so the</span></span>
<span class="r-in">  <span class="co"># and(female) term tells asreml to use the same levels (or, equivalently,</span></span>
<span class="r-in">  <span class="co"># fix the correlation of the male/female levels to be 1.</span></span>
<span class="r-in">  <span class="co"># The block effect is minimial and therefore ignored.</span></span>
<span class="r-in">  <span class="co">## libs(asreml, lucid)</span></span>
<span class="r-in">  <span class="co">## m1 &lt;- asreml(day~1, data=dat1,</span></span>
<span class="r-in">  <span class="co">##              random = ~ male + and(female) + comb + comb:dr)</span></span>
<span class="r-in">  <span class="co">## vc(m1)</span></span>
<span class="r-in">  <span class="co">##           effect component std.error z.ratio      con</span></span>
<span class="r-in">  <span class="co">##    male!male.var   12.77      7.502      1.7 Positive</span></span>
<span class="r-in">  <span class="co">##    comb!comb.var   11.11      3.353      3.3 Positive</span></span>
<span class="r-in">  <span class="co">## comb:dr!comb.var    0.6603    0.4926     1.3 Positive</span></span>
<span class="r-in">  <span class="co">##       R!variance    4.185     0.7449     5.6 Positive</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># ----------</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># 1952 data. Reproduce table 3 and figure 2 of Hayman 1954b.</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hayman.tobacco</span>, <span class="va">year</span><span class="op">==</span><span class="fl">1952</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Does flowering date follow a gamma distn?  Maybe.</span></span>
<span class="r-in">  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span><span class="op">~</span><span class="va">day</span>, data<span class="op">=</span><span class="va">dat2</span>, main<span class="op">=</span><span class="st">"hayman.tobacco"</span>,</span>
<span class="r-in">              xlab<span class="op">=</span><span class="st">"flowering date"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="hayman.tobacco-1.png" alt="" width="700" height="433"></span>
<span class="r-in">  </span>
<span class="r-in">  </span>
<span class="r-in">  <span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">block</span><span class="op">==</span><span class="st">'B1'</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">block</span><span class="op">==</span><span class="st">'B2'</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">reshape2</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">acast</span><span class="op">(</span><span class="va">d1</span>, <span class="va">male</span><span class="op">~</span><span class="va">female</span>, value.var<span class="op">=</span><span class="st">'day'</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">acast</span><span class="op">(</span><span class="va">d2</span>, <span class="va">male</span><span class="op">~</span><span class="va">female</span>, value.var<span class="op">=</span><span class="st">'day'</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="va">mn1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span class="r-in">  <span class="va">mn2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Variance and covariance of 'rth' offspring</span></span>
<span class="r-in">  <span class="va">vr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn1</span>, <span class="fl">1</span>, <span class="va">var</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">vr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn2</span>, <span class="fl">1</span>, <span class="va">var</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">wr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn1</span>, <span class="fl">1</span>, <span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mn1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">wr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn2</span>, <span class="fl">1</span>, <span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mn2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># Remove row names to prevent a mild warning</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mn1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mn2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span class="r-in">  <span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mn1</span>,<span class="va">mn2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">summ</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'B1'</span>,<span class="st">'B2'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">summ</span><span class="op">$</span><span class="va">vr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vr1</span>,<span class="va">vr2</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">summ</span><span class="op">$</span><span class="va">wr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wr1</span>,<span class="va">wr2</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">summ</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># Vr and Wr match Hayman table 3</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">summ</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wr</span><span class="op">~</span><span class="va">vr</span>, type<span class="op">=</span><span class="st">'n'</span>, main<span class="op">=</span><span class="st">"hayman.tobacco"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">summ</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">vr</span>, <span class="va">wr</span>, <span class="va">male</span><span class="op">)</span><span class="op">)</span> <span class="co"># Match Hayman figure 2</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="hayman.tobacco-2.png" alt="" width="700" height="433"></span>
<span class="r-in">  <span class="co"># Hayman notes that 1 and 3 do not lie along the line,</span></span>
<span class="r-in">  <span class="co"># so modifies them and re-analyzes.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

