<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes. — alwan.lamb • agridat</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="For the 34 sheep sires, the number of lambs in each of 5 foot shape classes. — alwan.lamb" />
<meta property="og:description" content="For the 34 sheep sires, the number of lambs in each of 5 foot shape classes." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agridat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    </li>
    <li>
      <a href="../articles/agridat_examples.html">Graphical Gems in the agridat Package</a>
    </li>
    <li>
      <a href="../articles/agridat_intro.html">Introduction to `agridat`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kwstat/agridat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes.</h1>
    
    <div class="hidden name"><code>alwan.lamb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"alwan.lamb"</span><span class='op'>)</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>A data frame with 340 observations on the following 11 variables.</p><dl>
    <dt><code>year</code></dt><dd><p>numeric 1980/1981</p></dd>
    <dt><code>breed</code></dt><dd><p>breed PP, BRP, BR</p></dd>
    <dt><code>sex</code></dt><dd><p>sex of lamb M/F</p></dd>
    <dt><code>sire0</code></dt><dd><p>sire ID according to Alwan</p></dd>
    <dt><code>shape</code></dt><dd><p>sire ID according to Gilmour</p></dd>
    <dt><code>count</code></dt><dd><p>number of lambs</p></dd>
    <dt><code>sire</code></dt><dd><p>shape of foot</p></dd>
    <dt><code>yr</code></dt><dd><p>numeric contrast for year</p></dd>
    <dt><code>b1</code></dt><dd><p>numeric contrast for breeds</p></dd>
    <dt><code>b2</code></dt><dd><p>numeric contrast for breeds</p></dd>
    <dt><code>b3</code></dt><dd><p>numeric contrast for breeds</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There were 2513 lambs classified on the presence of deformities in
  their feet.  The lambs represent the offspring of 34 sires, 5 strains,
  2 years.</p>
<p>The variables yr, b1, b2, b3 are numeric contrasts for the fixed
  effects as defined in the paper by Gilmour (1987) and used in the SAS
  example. Gilmour does not explain the reason for the particular
  contrasts. The counts for classes LF1, LF2, LF3 were combined.</p>
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Mohammed Alwan (1983).
  Studies of the flock mating performance of Booroola merino crossbred ram lambs, and the foot conditions in Booroola merino crossbreds and Perendale sheep grazed on hill country.
  Thesis, Massey University. https://hdl.handle.net/10179/5900
  Appendix I, II.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gilmour, Anderson, and Rae (1987).
  Variance components on an underlying scale for ordered multiple threshold categorical data using a generalized linear mixed model.
  Journal of Animal Breeding and Genetics, 104, 149-155.
  https://doi.org/10.1111/j.1439-0388.1987.tb00117.x</p>
<p>SAS/STAT(R) 9.2 Users Guide, Second Edition
  Example 38.11 Maximum Likelihood in Proportional Odds Model with Random Effects
  https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>

  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://kwstat.github.io/agridat/'>agridat</a></span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>alwan.lamb</span><span class='op'>)</span>
  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>alwan.lamb</span>

  <span class='co'># merge LF1 LF2 LF3 class counts, and combine M/F</span>
  <span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>)</span>
  <span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>==</span><span class='st'>"LF2"</span>, <span class='st'>"LF3"</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>)</span>
  <span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>==</span><span class='st'>"LF1"</span>, <span class='st'>"LF3"</span>, <span class='va'>dat</span><span class='op'>$</span><span class='va'>shape</span><span class='op'>)</span>
  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>~</span> <span class='va'>year</span><span class='op'>+</span><span class='va'>breed</span><span class='op'>+</span><span class='va'>sire0</span><span class='op'>+</span><span class='va'>sire</span><span class='op'>+</span><span class='va'>shape</span><span class='op'>+</span><span class='va'>yr</span><span class='op'>+</span><span class='va'>b1</span><span class='op'>+</span><span class='va'>b2</span><span class='op'>+</span><span class='va'>b3</span>,
                   <span class='va'>dat</span>, FUN<span class='op'>=</span><span class='va'>sum</span><span class='op'>)</span>

  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='va'>dat</span>,
                   year<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>year</span><span class='op'>)</span>, breed<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>breed</span><span class='op'>)</span>,
                   sire0<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sire0</span><span class='op'>)</span>, sire<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sire</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'># LF5 or LF3 first is a bit arbitary...affects the sign of the coefficients</span>
  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='va'>dat</span>, shape<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>shape</span>, levels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LF5"</span>,<span class='st'>"LF4"</span>,<span class='st'>"LF3"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># View counts by year and breed</span>
  <span class='fu'><a href='libs.html'>libs</a></span><span class='op'>(</span><span class='va'>latticeExtra</span><span class='op'>)</span>
  <span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>~</span> <span class='va'>year</span><span class='op'>+</span><span class='va'>breed</span><span class='op'>+</span><span class='va'>shape</span>, <span class='va'>dat</span>, FUN<span class='op'>=</span><span class='va'>sum</span><span class='op'>)</span>
  <span class='fu'>useOuterStrips</span><span class='op'>(</span><span class='fu'>barchart</span><span class='op'>(</span><span class='va'>count</span> <span class='op'>~</span> <span class='va'>shape</span><span class='op'>|</span><span class='va'>year</span><span class='op'>*</span><span class='va'>breed</span>, data<span class='op'>=</span><span class='va'>dat2</span>,
                          main<span class='op'>=</span><span class='st'>"alwan.lamb"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='alwan.lamb-1.png' alt='' width='700' height='433' /></div><div class='input'>
  <span class='co'># Model used by Gilmour and SAS</span>
  <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>count</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> 
  <span class='fu'><a href='libs.html'>libs</a></span><span class='op'>(</span><span class='va'>ordinal</span><span class='op'>)</span>
  <span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>clmm</span><span class='op'>(</span><span class='va'>shape</span> <span class='op'>~</span> <span class='va'>yr</span> <span class='op'>+</span> <span class='va'>b1</span> <span class='op'>+</span> <span class='va'>b2</span> <span class='op'>+</span> <span class='va'>b3</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>sire</span><span class='op'>)</span>, data<span class='op'>=</span><span class='va'>dat</span>,
             weights<span class='op'>=</span><span class='va'>count</span>, link<span class='op'>=</span><span class='st'>"probit"</span>, Hess<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span> <span class='co'># Very similar to Gilmour results</span>
</div><div class='output co'>#&gt; Cumulative Link Mixed Model fitted with the Laplace approximation
#&gt; 
#&gt; formula: shape ~ yr + b1 + b2 + b3 + (1 | sire)
#&gt; data:    dat
#&gt; 
#&gt;  link   threshold nobs logLik   AIC     niter     max.grad cond.H 
#&gt;  probit flexible  2513 -1935.06 3884.12 477(1435) 3.26e-03 3.7e+01
#&gt; 
#&gt; Random effects:
#&gt;  Groups Name        Variance Std.Dev.
#&gt;  sire   (Intercept) 0.04849  0.2202  
#&gt; Number of groups:  sire 34 
#&gt; 
#&gt; Coefficients:
#&gt;    Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; yr -0.14222    0.04834  -2.942  0.00326 ** 
#&gt; b1 -0.37808    0.07154  -5.285 1.26e-07 ***
#&gt; b2 -0.31570    0.09709  -3.252  0.00115 ** 
#&gt; b3  0.09887    0.06508   1.519  0.12872    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Threshold coefficients:
#&gt;         Estimate Std. Error z value
#&gt; LF5|LF4  0.37814    0.04907   7.707
#&gt; LF4|LF3  1.64351    0.05930  27.717</div><div class='input'>  <span class='fu'>ordinal</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ordinal/man/ranef.html'>ranef</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span> <span class='co'># sign is opposite of SAS</span>
</div><div class='output co'>#&gt; $sire
#&gt;      (Intercept)
#&gt; S01  0.254544356
#&gt; S02  0.163964153
#&gt; S03  0.069022446
#&gt; S04 -0.035227884
#&gt; S05 -0.062963869
#&gt; S06 -0.142210089
#&gt; S07 -0.228308187
#&gt; S08  0.362315018
#&gt; S09  0.092873448
#&gt; S10  0.062107084
#&gt; S11  0.049561258
#&gt; S12 -0.265957083
#&gt; S13 -0.293272810
#&gt; S14  0.104669108
#&gt; S15  0.041998914
#&gt; S16 -0.145156128
#&gt; S17  0.441200144
#&gt; S18  0.061379717
#&gt; S19  0.009783405
#&gt; S20 -0.136898196
#&gt; S21 -0.145735910
#&gt; S22 -0.224834944
#&gt; S23  0.271311572
#&gt; S24  0.220700448
#&gt; S25  0.118450870
#&gt; S26  0.082118202
#&gt; S27  0.029036648
#&gt; S28  0.027969069
#&gt; S29  0.027125179
#&gt; S30 -0.009727541
#&gt; S31 -0.095941137
#&gt; S32 -0.143177140
#&gt; S33 -0.196628516
#&gt; S34 -0.315856884
#&gt; </div><div class='input'>
  <span class='co'>## SAS var of sires .04849</span>
  <span class='co'>## Effect   Shape   Estimate   Standard Error   DF   t Value   Pr &gt; |t|</span>
  <span class='co'>## Intercept   1   0.3781   0.04907   29   7.71   &lt;.0001</span>
  <span class='co'>## Intercept   2   1.6435   0.05930   29   27.72   &lt;.0001</span>
  <span class='co'>## yr       0.1422   0.04834   2478   2.94   0.0033</span>
  <span class='co'>## b1       0.3781   0.07154   2478   5.28   &lt;.0001</span>
  <span class='co'>## b2       0.3157   0.09709   2478   3.25   0.0012</span>
  <span class='co'>## b3       -0.09887   0.06508   2478   -1.52   0.1289</span>
  
  <span class='co'>## Gilmour results for probit analysis</span>
  <span class='co'>## Int1   .370 +/- .052</span>
  <span class='co'>## Int2  1.603 +/- .061</span>
  <span class='co'>## Year  -.139 +/- .052</span>
  <span class='co'>## B1    -.370 +/- .076</span>
  <span class='co'>## B2    -.304 +/- .103</span>
  <span class='co'>## B3     .098 +/- .070</span>

  <span class='co'># Plot random sire effects with intervals, similar to SAS example</span>
  <span class='va'>plot.random</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>model</span>, <span class='va'>random.effect</span>, <span class='va'>ylim</span><span class='op'>=</span><span class='cn'>NULL</span>, <span class='va'>xlab</span><span class='op'>=</span><span class='st'>""</span>, <span class='va'>main</span><span class='op'>=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'>ordinal</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ordinal/man/ranef.html'>ranef</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span><span class='op'>[[</span><span class='va'>random.effect</span><span class='op'>]</span><span class='op'>]</span>
    <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>lab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span>, est<span class='op'>=</span><span class='va'>tab</span><span class='op'>$</span><span class='st'>"(Intercept)"</span><span class='op'>)</span>
    <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='va'>tab</span>,
                     lo <span class='op'>=</span> <span class='va'>est</span> <span class='op'>-</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>$</span><span class='va'>condVar</span><span class='op'>)</span>,
                     hi <span class='op'>=</span> <span class='va'>est</span> <span class='op'>+</span> <span class='fl'>1.96</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>$</span><span class='va'>condVar</span><span class='op'>)</span><span class='op'>)</span>
    <span class='co'># sort by est, and return index</span>
    <span class='va'>ix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>$</span><span class='va'>est</span><span class='op'>)</span>
    <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='va'>tab</span><span class='op'>[</span><span class='va'>ix</span>,<span class='op'>]</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>ylim</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>$</span><span class='va'>lo</span>, <span class='va'>tab</span><span class='op'>$</span><span class='va'>hi</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>, <span class='va'>tab</span><span class='op'>$</span><span class='va'>est</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span>, ylim<span class='op'>=</span><span class='va'>ylim</span>, xlab<span class='op'>=</span><span class='va'>xlab</span>,
         ylab<span class='op'>=</span><span class='st'>"effect"</span>, main<span class='op'>=</span><span class='va'>main</span>, type<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>, <span class='va'>tab</span><span class='op'>$</span><span class='va'>est</span>, labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>$</span><span class='va'>lab</span>,<span class='fl'>2</span><span class='op'>)</span> , cex<span class='op'>=</span><span class='fl'>.75</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/segments.html'>segments</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>, <span class='va'>tab</span><span class='op'>$</span><span class='va'>lo</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span>, <span class='va'>tab</span><span class='op'>$</span><span class='va'>hi</span>, col<span class='op'>=</span><span class='st'>"gray30"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.5</span>, <span class='op'>-</span><span class='fl'>.25</span>, <span class='fl'>0</span>, <span class='fl'>.25</span>, <span class='fl'>.5</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"gray"</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>ix</span><span class='op'>)</span>  
  <span class='op'>}</span>
  <span class='va'>ix</span> <span class='op'>&lt;-</span> <span class='fu'>plot.random</span><span class='op'>(</span><span class='va'>m1</span>, <span class='st'>"sire"</span><span class='op'>)</span>
</div><div class='img'><img src='alwan.lamb-2.png' alt='' width='700' height='433' /></div><div class='input'>
  <span class='co'># foot-shape proportions for each sire, sorted by estimated sire effects</span>
  <span class='co'># positive sire effects tend to have lower proportion of lambs in LF4 and LF5</span>
  <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>~</span> <span class='va'>sire</span><span class='op'>+</span><span class='va'>shape</span>, <span class='va'>dat</span><span class='op'>)</span>, margin<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='va'>tab</span><span class='op'>[</span><span class='va'>ix</span>,<span class='op'>]</span>
  <span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='va'>tab</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='co'># reverse the order</span>
  <span class='fu'>lattice</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>barchart</a></span><span class='op'>(</span><span class='va'>tab</span>,
                    horizontal<span class='op'>=</span><span class='cn'>FALSE</span>, auto.key<span class='op'>=</span><span class='cn'>TRUE</span>,
                    main<span class='op'>=</span><span class='st'>"alwan.lamb"</span>, xlab<span class='op'>=</span><span class='st'>"Sire"</span>, ylab<span class='op'>=</span><span class='st'>"Proportion of lambs"</span>,
                    scales<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rot<span class='op'>=</span><span class='fl'>70</span><span class='op'>)</span><span class='op'>)</span>,
                    par.settings <span class='op'>=</span> <span class='fu'>simpleTheme</span><span class='op'>(</span>col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"yellow"</span>,<span class='st'>"orange"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span>
</div><div class='img'><img src='alwan.lamb-3.png' alt='' width='700' height='433' /></div><div class='input'>  
  <span class='kw'><a href='https://rdrr.io/r/base/detach.html'>detach</a></span><span class='op'>(</span><span class='st'>"package:ordinal"</span><span class='op'>)</span> <span class='co'># to avoid VarCorr clash with lme4</span>
  
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


